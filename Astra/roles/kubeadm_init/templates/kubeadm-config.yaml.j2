# roles/kubeadm_init/templates/kubeadm-config.yaml.j2
apiVersion: kubeadm.k8s.io/v1beta3
kind: InitConfiguration
localAPIEndpoint:
    advertiseAddress: "{{ k8s_advertise_address }}"
    bindPort: 6443
---
apiVersion: kubeadm.k8s.io/v1beta3
kind: ClusterConfiguration
kubernetesVersion: "{{ k8s_version }}"
controlPlaneEndpoint: "{{ k8s_cp_endpoint }}"
networking:
    podSubnet: "{{ k8s_pod_subnet }}"
apiServer:
    certSANs:
{% for san in k8s_cert_sans %}
        - "{{ san }}"
{% endfor %}
---
apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
cgroupDriver: "{{ kubelet_cgroup_driver | default('systemd') }}"